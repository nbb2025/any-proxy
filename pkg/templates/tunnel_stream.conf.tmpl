# Generated by any-proxy - tunnel node {{ .NodeID }} at {{ .GeneratedAt }}
stream {
{{- range .Routes }}
    upstream {{ .Name }} {
        server {{ .TargetAddress }};
    }

    server {
        listen {{ .ListenAddress }};
        proxy_pass {{ .Name }};
{{- if .IdleTimeout }}
        proxy_timeout {{ .IdleTimeout }};
{{- end }}
{{- if eq .Protocol "udp" }}
        proxy_responses 1;
{{- end }}
{{- if .EnableProxyProto }}
        proxy_protocol on;
{{- end }}
    }
{{- end }}
}
